@use '../../foundation/breakpoints' as breakpoints;
@use '../../foundation/spaces' as spaces;
@use '../../foundation/sizes' as sizes;
@use '../../foundation/depth' as depth;
@use '../../foundation/motion' as motion;
@use '../../foundation/colors' as colors;

.ch-dropdown {
  // 1. Base

  @include breakpoints.media(from, desktop) {
    position: relative;
  }

  display: inline-block;

  // 2. Overlay

  > .ch-overlay {
    @include breakpoints.media(to, tablet) {
      @include spaces.inset(default, xs);

      display: flex;
      flex-direction: column-reverse;
      align-items: center;
    }

    @include breakpoints.media(from, desktop) {
      @include spaces.paddingless;

      position: absolute;

      margin-top: spaces.get-space(xs);
      width: auto;
      min-width: sizes.get-size(2);
      height: auto;
      background: transparent;
    }

    // 2.1. Overlay content

    > .ch-card {
      @include breakpoints.media(to, tablet) {
        transform: translate(0, 10%);

        width: 100%;
        max-width: calc(2 * #{sizes.get-size(2)});
        max-height: 60vh;
        border: 0;
      }

      @include breakpoints.media(from, desktop) {
        @include depth.shadow(2);

        transition-duration: motion.$transition-duration-very-fast;

        width: auto;
      }

      @include depth.shadow(5, top-bottom, #{colors.$black});
      @include motion.transition(transform);

      width: 100%;
      overflow-x: hidden;
      overflow-y: auto;
    }

    // 2.2. Not visible state

    &:not(.is-visible) {
      @include breakpoints.media(from, desktop) {
        transition-duration: 0s;

        max-width: 0;
        min-width: 0;
        max-height: 0;
        min-height: 0;
        overflow: hidden;
      }
    }

    // 2.3. Visible state

    &.is-visible {
      @include breakpoints.media(from, desktop) {
        display: block;

        background: transparent;
      }

      // 2.2.1. Overlay content

      > .ch-card {
        transform: translate(0, 0);

        opacity: 1;
      }
    }
  }

  // 3. Contained variation

  &--contained {
    > .ch-overlay > .ch-card {
      @include breakpoints.media(from, desktop) {
        width: sizes.get-size(3);
        max-height: 50vh;
      }

      display: flex;
      flex-direction: column;
      flex-wrap: nowrap;

      > .ch-card-content {
        flex: 1;
        overflow-y: auto;

        margin-bottom: 0;
      }
    }
  }
}
